数据库事务
ACID
原子性
一致性
持久性
隔离性
解释上述四个名称
原子性 要么执行成功要么执行失败
一致性 事务执行是从一个状态转移到另一个状态,不存在中间状态
隔离性 事务之间互不影响，通过数据库锁来实现
持久性 事务执行成功后数据的状态就已经存在了硬盘上了,即使崩溃了也能恢复数据,
数据库事务断电怎么办？
redo日志和undo日志
每次执行操作之前将命令写到redo日志文件中并存入磁盘
然后才真正执行命令
将上一个数据的状态保存到undo日志中
将将要执行的更改状态命令的语句保存到redo日志中
原子性 一致性 通过redo日志来实现
持久性通过undo日志来实现
隔离性通过数据库锁来实现
隔离性是多个事务同时运行,每个事务原则上不能读取到其他事务的中间状态,只能读取到事务前或者事务后数据的状态
首先看多个事务同时运行会产生一些什么问题
    脏读  一个事务读取了另一个事务未提交的数据
        初始状态a=1
        事务A执行a=2
        事务B开始执行
        事务B读取a的值
        a=2
        事务A再执行a=3
        事务A提交
        事务B执行a=a+4=6
        事务B提交
    如何解决脏读?
        通过事务隔离级别读提交来解决
    事务的隔离级别是数据库不同锁的具体体现
数据库的锁
    排他锁
    共享锁

    悲观锁
    乐观锁



什么是事务？
将一系列连续的活动划分为一个不可分割的单位并执行
CAP理论中的P代表什么？
P是分区容忍性
    指的是当网络发生故障时,比如两个局域网互相无法联通,而两个局域网中的数据库数据都是只有单独一份的,那么此时
    数据就发生了分区,如果要保证能够访问其他数据,那么就要数据备份在多个几点上
    但同时也带来了一致性,更新操作需要同时更新多份数据,如果要求强一致性,此时又会带来某一个时间点集群不可用
    所以可用性减少了
    如果集群的机器分为了两部分,这两部分不能通信,系统是否能工作
    这个是个连续值,分成两部分的时间是0-永久,
真实的网络系统中,节点之间不可能保持同步

两阶段提交
事务协调器
    询问多个节点是否可以提交事务
    如果都返回是则发送真正提交的命令
    如果有一个返回否则执行回滚操作

    同步操作,第一阶段等待所有节点返回,如果有一个长时间未返回则会阻塞
    协调器存在单点问题
三阶段提交

通过消息队列(但同时又引入了消息队列的)
    生产者产生消息
        生产者产生消息后通过网络发送消息到消息队列
    消费者消费消息
        消费者通过网络接受消息
    网络延迟？
    网络异常？
    如何确保消息生产和消息消费成功?

# 分布式事务

